# _C. Elegans_ Network Connectivity and Correlated Gene Expression

This repository provides the code for reproducing a range of analyses involving processing connectivity and gene expression data for *C. elegans*, and running a range of analyses to relate patterns in both measurements.

Please read our paper, and if you use this code, please cite our paper:

A. Arnatkeviciute\*, B.D. Fulcher\*, R. Pocock, and A. Fornito. [Hub connectivity, neuronal diversity, and gene expression in the _C. elegans_ connectome](https://www.biorxiv.org/content/early/2017/10/21/207134), _bioRxiv_ 207134.

Contact Aurina Arnatkeviciute by [email](mailto:aurina.arnatkeviciute@monash.edu) or Ben Fulcher by [email](mailto:ben.d.fulcher@gmail.com) or [twitter](https://twitter.com/bendfulcher).

Dependencies:
[Brain Connectivity Toolbox](https://sites.google.com/site/bctnet/), Version 2017-15-01.


### Scripts
In order to reproduce data used in the analyses please download the contents of this repository.

### Data files
Data files required for this project are hosted on [this figshare repository](https://figshare.com/s/797199619fbabdab8c86).
Please create a directory called **Data** in the root directory of this repository and download data there.

### Data processing
After retrieving data, data files needed for analysis can be generated by running:
```matlab
RegenerateData;
```
which is located in DataProcessing folder. It will create CElegansConnectivityData.mat file containing neuronal connectivity related data structure C and WS256_CertainEmptyEnrichedPartial.mat file containing gene expression related data structure G. Run `LoadAllData` to add all required paths and load necessary gene expression and connectivity data (stored in `G` and `C` data structures, respectively).

Gene expression matrix in the format 279 (neurons) x 948 (genes) is located in G.GeneExpData.Direct;

Binary connectivity matrices for 3 network representations (chemical synapses, electrical synapses, chemical and electrical synapses combined) are located in C.Adj_B cell.

Weighted connectivity matrices for 3 network representations (chemical synapses, electrical synapses, chemical and electrical synapses combined) are located in C.Adj_W cell.

### Analysis
Figures in our paper can be regenerated using functions in the **FigureGenerators** directory. All scripts should be run from the root directory.
Other relevant analysis scripts are in **Analysis**.
